{"ast":null,"code":"\"use strict\";\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _filter = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\"));\n\nvar _reduce = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/reduce\"));\n\nvar _padStart = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/pad-start\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/createClass\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/toConsumableArray\"));\n\nvar _createSigningData = _interopRequireDefault(require(\"./createSigningData\"));\n\nvar _ParseUser = _interopRequireDefault(require(\"./ParseUser\"));\n\nvar _ParseQuery = _interopRequireDefault(require(\"./ParseQuery\"));\n\nvar _ParseObject = _interopRequireDefault(require(\"./ParseObject\"));\n\nvar _ParseACL = _interopRequireDefault(require(\"./ParseACL\"));\n/* global window */\n\n/* global solanaWeb3 */\n\n\nvar base64 = {\n  decode: function (s) {\n    return Uint8Array.from(atob(s), function (c) {\n      return c.charCodeAt(0);\n    });\n  },\n  encode: function (b) {\n    return btoa(String.fromCharCode.apply(String, (0, _toConsumableArray2.default)(new Uint8Array(b))));\n  }\n};\n\nvar MoralisSol = /*#__PURE__*/function () {\n  function MoralisSol() {\n    (0, _classCallCheck2.default)(this, MoralisSol);\n  }\n\n  (0, _createClass2.default)(MoralisSol, null, [{\n    key: \"authenticate\",\n    value: function () {\n      var _authenticate = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(options) {\n        var _context, _user$get;\n\n        var phantom, solAddress, accounts, message, data, signature, authData, user;\n        return _regenerator.default.wrap(function (_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return MoralisSol.enable();\n\n              case 2:\n                phantom = _context2.sent;\n\n                if (phantom) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                throw new Error('Phantom wallet not available');\n\n              case 5:\n                solAddress = phantom.publicKey.toString();\n\n                if (solAddress) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                throw new Error('Address not found');\n\n              case 8:\n                accounts = [solAddress];\n                message = (options === null || options === void 0 ? void 0 : options.signingMessage) || MoralisSol.getSigningData();\n                _context2.next = 12;\n                return (0, _createSigningData.default)(message);\n\n              case 12:\n                data = _context2.sent;\n                _context2.next = 15;\n                return MoralisSol.sign(data);\n\n              case 15:\n                signature = _context2.sent;\n                authData = {\n                  id: solAddress,\n                  signature: signature,\n                  data: data\n                };\n                _context2.next = 19;\n                return _ParseUser.default.logInWith('moralisSol', {\n                  authData: authData\n                });\n\n              case 19:\n                user = _context2.sent;\n                _context2.next = 22;\n                return user.setACL(new _ParseACL.default(user));\n\n              case 22:\n                if (user) {\n                  _context2.next = 24;\n                  break;\n                }\n\n                throw new Error('Could not get user');\n\n              case 24:\n                user.set('solAccounts', uniq((0, _concat.default)(_context = []).call(_context, accounts, (_user$get = user.get('solAccounts')) !== null && _user$get !== void 0 ? _user$get : [])));\n                user.set('solAddress', solAddress);\n                _context2.next = 28;\n                return user.save();\n\n              case 28:\n                return _context2.abrupt(\"return\", user);\n\n              case 29:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function () {\n        return _authenticate.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"link\",\n    value: function () {\n      var _link = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2(account, options) {\n        var _context3, _user$get2;\n\n        var message, user, solAddress, SolAddress, query, solAddressRecord, data, signature, authData;\n        return _regenerator.default.wrap(function (_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                message = (options === null || options === void 0 ? void 0 : options.signingMessage) || MoralisSol.getSigningData();\n                _context4.next = 3;\n                return _ParseUser.default.current();\n\n              case 3:\n                user = _context4.sent;\n                solAddress = account;\n                SolAddress = _ParseObject.default.extend('_SolAddress');\n                query = new _ParseQuery.default(SolAddress);\n                _context4.next = 9;\n                return query.get(solAddress).catch(function () {\n                  return null;\n                });\n\n              case 9:\n                solAddressRecord = _context4.sent;\n\n                if (solAddressRecord) {\n                  _context4.next = 20;\n                  break;\n                }\n\n                _context4.next = 13;\n                return (0, _createSigningData.default)(message);\n\n              case 13:\n                data = _context4.sent;\n                _context4.next = 16;\n                return MoralisSol.sign(solAddress, data);\n\n              case 16:\n                signature = _context4.sent;\n                authData = {\n                  id: solAddress,\n                  signature: signature,\n                  data: data\n                };\n                _context4.next = 20;\n                return user.linkWith('moralisSol', {\n                  authData: authData\n                });\n\n              case 20:\n                user.set('SolAccounts', uniq((0, _concat.default)(_context3 = [solAddress]).call(_context3, (_user$get2 = user.get('SolAccounts')) !== null && _user$get2 !== void 0 ? _user$get2 : [])));\n                user.set('solAddress', solAddress);\n                _context4.next = 24;\n                return user.save();\n\n              case 24:\n                return _context4.abrupt(\"return\", user);\n\n              case 25:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function () {\n        return _link.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"unlink\",\n    value: function () {\n      var _unlink = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3(account) {\n        var _user$get3;\n\n        var accountsLower, SolAddress, query, solAddressRecord, user, accounts, nextAccounts;\n        return _regenerator.default.wrap(function (_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                accountsLower = account;\n                SolAddress = _ParseObject.default.extend('_SolAddress');\n                query = new _ParseQuery.default(SolAddress);\n                _context5.next = 5;\n                return query.get(accountsLower);\n\n              case 5:\n                solAddressRecord = _context5.sent;\n                _context5.next = 8;\n                return solAddressRecord.destroy();\n\n              case 8:\n                _context5.next = 10;\n                return _ParseUser.default.current();\n\n              case 10:\n                user = _context5.sent;\n                accounts = (_user$get3 = user.get('solAccounts')) !== null && _user$get3 !== void 0 ? _user$get3 : [];\n                nextAccounts = (0, _filter.default)(accounts).call(accounts, function (v) {\n                  return v !== accountsLower;\n                });\n                user.set('solAccounts', nextAccounts);\n                user.set('solAddress', nextAccounts[0]);\n                _context5.next = 17;\n                return user._unlinkFrom('moralisSol');\n\n              case 17:\n                _context5.next = 19;\n                return user.save();\n\n              case 19:\n                return _context5.abrupt(\"return\", user);\n\n              case 20:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function () {\n        return _unlink.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"sign\",\n    value: function () {\n      var _sign = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4(message) {\n        var phantom, encodedMessage, signedMessage;\n        return _regenerator.default.wrap(function (_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return MoralisSol.enable();\n\n              case 2:\n                phantom = _context6.sent;\n                encodedMessage = new TextEncoder().encode(message);\n                _context6.next = 6;\n                return phantom.signMessage(encodedMessage, 'utf8');\n\n              case 6:\n                signedMessage = _context6.sent;\n                return _context6.abrupt(\"return\", base64.encode(signedMessage.signature));\n\n              case 8:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function () {\n        return _sign.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"getSigningData\",\n    value: function () {\n      return 'Moralis Authentication';\n    }\n  }]);\n  return MoralisSol;\n}();\n\n(0, _defineProperty2.default)(MoralisSol, \"enable\", /*#__PURE__*/(0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5() {\n  var provider;\n  return _regenerator.default.wrap(function (_context8) {\n    while (1) {\n      switch (_context8.prev = _context8.next) {\n        case 0:\n          if (!(window && 'solana' in window)) {\n            _context8.next = 17;\n            break;\n          }\n\n          provider = window.solana;\n\n          if (!provider.isPhantom) {\n            _context8.next = 17;\n            break;\n          }\n\n          _context8.prev = 3;\n          _context8.next = 6;\n          return provider.connect({\n            onlyIfTrusted: true\n          });\n\n        case 6:\n          _context8.next = 16;\n          break;\n\n        case 8:\n          _context8.prev = 8;\n          _context8.t0 = _context8[\"catch\"](3);\n\n          if (!(_context8.t0.message === 'User rejected the request.')) {\n            _context8.next = 15;\n            break;\n          }\n\n          _context8.next = 13;\n          return provider.connect();\n\n        case 13:\n          _context8.next = 16;\n          break;\n\n        case 15:\n          throw _context8.t0;\n\n        case 16:\n          return _context8.abrupt(\"return\", provider);\n\n        case 17:\n          throw new Error('Phantom wallet not available');\n\n        case 18:\n        case \"end\":\n          return _context8.stop();\n      }\n    }\n  }, _callee5, null, [[3, 8]]);\n})));\n\nfunction toHexString(buffer\n/*: Buffer*/\n) {\n  return (0, _reduce.default)(buffer).call(buffer, function (str, byte) {\n    var _context7;\n\n    return str + (0, _padStart.default)(_context7 = byte.toString(16)).call(_context7, 2, '0');\n  }, '');\n}\n\nfunction uniq(arr) {\n  return (0, _filter.default)(arr).call(arr, function (v, i) {\n    return (0, _indexOf.default)(arr).call(arr, v) === i;\n  });\n}\n\nvar _default = MoralisSol;\nexports.default = _default;","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/Twitter-Start/node_modules/moralis/lib/browser/MoralisSol.js"],"names":["_Object$defineProperty","require","_interopRequireDefault","exports","value","default","_regenerator","_concat","_filter","_reduce","_padStart","_indexOf","_asyncToGenerator2","_classCallCheck2","_createClass2","_defineProperty2","_toConsumableArray2","_createSigningData","_ParseUser","_ParseQuery","_ParseObject","_ParseACL","base64","decode","s","Uint8Array","from","atob","c","charCodeAt","encode","b","btoa","String","fromCharCode","apply","MoralisSol","key","_authenticate","mark","_callee","options","_context","_user$get","phantom","solAddress","accounts","message","data","signature","authData","user","wrap","_context2","prev","next","enable","sent","Error","publicKey","toString","signingMessage","getSigningData","sign","id","logInWith","setACL","set","uniq","call","get","save","abrupt","stop","arguments","_link","_callee2","account","_context3","_user$get2","SolAddress","query","solAddressRecord","_context4","current","extend","catch","linkWith","_unlink","_callee3","_user$get3","accountsLower","nextAccounts","_context5","destroy","v","_unlinkFrom","_sign","_callee4","encodedMessage","signedMessage","_context6","TextEncoder","signMessage","_callee5","provider","_context8","window","solana","isPhantom","connect","onlyIfTrusted","t0","toHexString","buffer","str","byte","_context7","arr","i","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _filter = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\"));\n\nvar _reduce = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/reduce\"));\n\nvar _padStart = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/pad-start\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/createClass\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/toConsumableArray\"));\n\nvar _createSigningData = _interopRequireDefault(require(\"./createSigningData\"));\n\nvar _ParseUser = _interopRequireDefault(require(\"./ParseUser\"));\n\nvar _ParseQuery = _interopRequireDefault(require(\"./ParseQuery\"));\n\nvar _ParseObject = _interopRequireDefault(require(\"./ParseObject\"));\n\nvar _ParseACL = _interopRequireDefault(require(\"./ParseACL\"));\n/* global window */\n\n/* global solanaWeb3 */\n\n\nvar base64 = {\n  decode: function (s) {\n    return Uint8Array.from(atob(s), function (c) {\n      return c.charCodeAt(0);\n    });\n  },\n  encode: function (b) {\n    return btoa(String.fromCharCode.apply(String, (0, _toConsumableArray2.default)(new Uint8Array(b))));\n  }\n};\n\nvar MoralisSol = /*#__PURE__*/function () {\n  function MoralisSol() {\n    (0, _classCallCheck2.default)(this, MoralisSol);\n  }\n\n  (0, _createClass2.default)(MoralisSol, null, [{\n    key: \"authenticate\",\n    value: function () {\n      var _authenticate = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(options) {\n        var _context, _user$get;\n\n        var phantom, solAddress, accounts, message, data, signature, authData, user;\n        return _regenerator.default.wrap(function (_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return MoralisSol.enable();\n\n              case 2:\n                phantom = _context2.sent;\n\n                if (phantom) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                throw new Error('Phantom wallet not available');\n\n              case 5:\n                solAddress = phantom.publicKey.toString();\n\n                if (solAddress) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                throw new Error('Address not found');\n\n              case 8:\n                accounts = [solAddress];\n                message = (options === null || options === void 0 ? void 0 : options.signingMessage) || MoralisSol.getSigningData();\n                _context2.next = 12;\n                return (0, _createSigningData.default)(message);\n\n              case 12:\n                data = _context2.sent;\n                _context2.next = 15;\n                return MoralisSol.sign(data);\n\n              case 15:\n                signature = _context2.sent;\n                authData = {\n                  id: solAddress,\n                  signature: signature,\n                  data: data\n                };\n                _context2.next = 19;\n                return _ParseUser.default.logInWith('moralisSol', {\n                  authData: authData\n                });\n\n              case 19:\n                user = _context2.sent;\n                _context2.next = 22;\n                return user.setACL(new _ParseACL.default(user));\n\n              case 22:\n                if (user) {\n                  _context2.next = 24;\n                  break;\n                }\n\n                throw new Error('Could not get user');\n\n              case 24:\n                user.set('solAccounts', uniq((0, _concat.default)(_context = []).call(_context, accounts, (_user$get = user.get('solAccounts')) !== null && _user$get !== void 0 ? _user$get : [])));\n                user.set('solAddress', solAddress);\n                _context2.next = 28;\n                return user.save();\n\n              case 28:\n                return _context2.abrupt(\"return\", user);\n\n              case 29:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function () {\n        return _authenticate.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"link\",\n    value: function () {\n      var _link = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2(account, options) {\n        var _context3, _user$get2;\n\n        var message, user, solAddress, SolAddress, query, solAddressRecord, data, signature, authData;\n        return _regenerator.default.wrap(function (_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                message = (options === null || options === void 0 ? void 0 : options.signingMessage) || MoralisSol.getSigningData();\n                _context4.next = 3;\n                return _ParseUser.default.current();\n\n              case 3:\n                user = _context4.sent;\n                solAddress = account;\n                SolAddress = _ParseObject.default.extend('_SolAddress');\n                query = new _ParseQuery.default(SolAddress);\n                _context4.next = 9;\n                return query.get(solAddress).catch(function () {\n                  return null;\n                });\n\n              case 9:\n                solAddressRecord = _context4.sent;\n\n                if (solAddressRecord) {\n                  _context4.next = 20;\n                  break;\n                }\n\n                _context4.next = 13;\n                return (0, _createSigningData.default)(message);\n\n              case 13:\n                data = _context4.sent;\n                _context4.next = 16;\n                return MoralisSol.sign(solAddress, data);\n\n              case 16:\n                signature = _context4.sent;\n                authData = {\n                  id: solAddress,\n                  signature: signature,\n                  data: data\n                };\n                _context4.next = 20;\n                return user.linkWith('moralisSol', {\n                  authData: authData\n                });\n\n              case 20:\n                user.set('SolAccounts', uniq((0, _concat.default)(_context3 = [solAddress]).call(_context3, (_user$get2 = user.get('SolAccounts')) !== null && _user$get2 !== void 0 ? _user$get2 : [])));\n                user.set('solAddress', solAddress);\n                _context4.next = 24;\n                return user.save();\n\n              case 24:\n                return _context4.abrupt(\"return\", user);\n\n              case 25:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function () {\n        return _link.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"unlink\",\n    value: function () {\n      var _unlink = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3(account) {\n        var _user$get3;\n\n        var accountsLower, SolAddress, query, solAddressRecord, user, accounts, nextAccounts;\n        return _regenerator.default.wrap(function (_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                accountsLower = account;\n                SolAddress = _ParseObject.default.extend('_SolAddress');\n                query = new _ParseQuery.default(SolAddress);\n                _context5.next = 5;\n                return query.get(accountsLower);\n\n              case 5:\n                solAddressRecord = _context5.sent;\n                _context5.next = 8;\n                return solAddressRecord.destroy();\n\n              case 8:\n                _context5.next = 10;\n                return _ParseUser.default.current();\n\n              case 10:\n                user = _context5.sent;\n                accounts = (_user$get3 = user.get('solAccounts')) !== null && _user$get3 !== void 0 ? _user$get3 : [];\n                nextAccounts = (0, _filter.default)(accounts).call(accounts, function (v) {\n                  return v !== accountsLower;\n                });\n                user.set('solAccounts', nextAccounts);\n                user.set('solAddress', nextAccounts[0]);\n                _context5.next = 17;\n                return user._unlinkFrom('moralisSol');\n\n              case 17:\n                _context5.next = 19;\n                return user.save();\n\n              case 19:\n                return _context5.abrupt(\"return\", user);\n\n              case 20:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function () {\n        return _unlink.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"sign\",\n    value: function () {\n      var _sign = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4(message) {\n        var phantom, encodedMessage, signedMessage;\n        return _regenerator.default.wrap(function (_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return MoralisSol.enable();\n\n              case 2:\n                phantom = _context6.sent;\n                encodedMessage = new TextEncoder().encode(message);\n                _context6.next = 6;\n                return phantom.signMessage(encodedMessage, 'utf8');\n\n              case 6:\n                signedMessage = _context6.sent;\n                return _context6.abrupt(\"return\", base64.encode(signedMessage.signature));\n\n              case 8:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function () {\n        return _sign.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"getSigningData\",\n    value: function () {\n      return 'Moralis Authentication';\n    }\n  }]);\n  return MoralisSol;\n}();\n\n(0, _defineProperty2.default)(MoralisSol, \"enable\", /*#__PURE__*/(0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5() {\n  var provider;\n  return _regenerator.default.wrap(function (_context8) {\n    while (1) {\n      switch (_context8.prev = _context8.next) {\n        case 0:\n          if (!(window && 'solana' in window)) {\n            _context8.next = 17;\n            break;\n          }\n\n          provider = window.solana;\n\n          if (!provider.isPhantom) {\n            _context8.next = 17;\n            break;\n          }\n\n          _context8.prev = 3;\n          _context8.next = 6;\n          return provider.connect({\n            onlyIfTrusted: true\n          });\n\n        case 6:\n          _context8.next = 16;\n          break;\n\n        case 8:\n          _context8.prev = 8;\n          _context8.t0 = _context8[\"catch\"](3);\n\n          if (!(_context8.t0.message === 'User rejected the request.')) {\n            _context8.next = 15;\n            break;\n          }\n\n          _context8.next = 13;\n          return provider.connect();\n\n        case 13:\n          _context8.next = 16;\n          break;\n\n        case 15:\n          throw _context8.t0;\n\n        case 16:\n          return _context8.abrupt(\"return\", provider);\n\n        case 17:\n          throw new Error('Phantom wallet not available');\n\n        case 18:\n        case \"end\":\n          return _context8.stop();\n      }\n    }\n  }, _callee5, null, [[3, 8]]);\n})));\n\nfunction toHexString(buffer\n/*: Buffer*/\n) {\n  return (0, _reduce.default)(buffer).call(buffer, function (str, byte) {\n    var _context7;\n\n    return str + (0, _padStart.default)(_context7 = byte.toString(16)).call(_context7, 2, '0');\n  }, '');\n}\n\nfunction uniq(arr) {\n  return (0, _filter.default)(arr).call(arr, function (v, i) {\n    return (0, _indexOf.default)(arr).call(arr, v) === i;\n  });\n}\n\nvar _default = MoralisSol;\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}