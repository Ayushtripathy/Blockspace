{"ast":null,"code":"\"use strict\";\n\nvar _Object$keys = require(\"@babel/runtime-corejs3/core-js-stable/object/keys\");\n\nvar _Object$getOwnPropertySymbols = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\");\n\nvar _filterInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\");\n\nvar _Object$getOwnPropertyDescriptor = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\");\n\nvar _forEachInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\");\n\nvar _Object$getOwnPropertyDescriptors = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\");\n\nvar _Object$defineProperties = require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/slicedToArray\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\n\nvar _ParseFileEncode = require(\"./ParseFileEncode\");\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = _Object$keys(object);\n\n  if (_Object$getOwnPropertySymbols) {\n    var symbols = _Object$getOwnPropertySymbols(object);\n\n    enumerableOnly && (symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var _context2, _context3;\n\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? _forEachInstanceProperty(_context2 = ownKeys(Object(source), !0)).call(_context2, function (key) {\n      (0, _defineProperty2.default)(target, key, source[key]);\n    }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)) : _forEachInstanceProperty(_context3 = ownKeys(Object(source))).call(_context3, function (key) {\n      _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar XHR = null;\n\nif (typeof XMLHttpRequest !== 'undefined') {\n  XHR = XMLHttpRequest;\n}\n\nvar DefaultController = {\n  saveFile: function () {\n    var _saveFile = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(name\n    /*: string*/\n    , source\n    /*: FileSource*/\n    , options\n    /*:: ?: FullOptions*/\n    ) {\n      var base64Data, _base64Data$split, _base64Data$split2, first, second, data, newSource;\n\n      return _regenerator.default.wrap(function (_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(source.format !== 'file')) {\n                _context.next = 2;\n                break;\n              }\n\n              throw new Error('saveFile can only be used with File-type sources.');\n\n            case 2:\n              _context.next = 4;\n              return new _promise.default(function (res, rej) {\n                // eslint-disable-next-line no-undef\n                var reader = new FileReader();\n\n                reader.onload = function () {\n                  return res(reader.result);\n                };\n\n                reader.onerror = function (error) {\n                  return rej(error);\n                };\n\n                reader.readAsDataURL(source.file);\n              });\n\n            case 4:\n              base64Data = _context.sent; // we only want the data after the comma\n              // For example: \"data:application/pdf;base64,JVBERi0xLjQKJ...\" we would only want \"JVBERi0xLjQKJ...\"\n\n              _base64Data$split = base64Data.split(','), _base64Data$split2 = (0, _slicedToArray2.default)(_base64Data$split, 2), first = _base64Data$split2[0], second = _base64Data$split2[1]; // in the event there is no 'data:application/pdf;base64,' at the beginning of the base64 string\n              // use the entire string instead\n\n              data = second ? second : first;\n              newSource = {\n                format: 'base64',\n                base64: data,\n                type: source.type || (source.file ? source.file.type : null)\n              };\n              _context.next = 10;\n              return DefaultController.saveBase64(name, newSource, options);\n\n            case 10:\n              return _context.abrupt(\"return\", _context.sent);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function () {\n      return _saveFile.apply(this, arguments);\n    };\n  }(),\n  saveBase64: function (name\n  /*: string*/\n  , source\n  /*: FileSource*/\n  , options\n  /*:: ?: FullOptions*/\n  ) {\n    if (source.format !== 'base64') {\n      throw new Error('saveBase64 can only be used with Base64-type sources.');\n    }\n\n    var data\n    /*: { base64: any, _ContentType?: any, fileData: Object }*/\n    = {\n      base64: source.base64,\n      fileData: {\n        ipfs: options.ipfs,\n        metadata: _objectSpread({}, options.metadata),\n        tags: _objectSpread({}, options.tags)\n      }\n    };\n    delete options.metadata;\n    delete options.tags;\n\n    if (source.type) {\n      data._ContentType = source.type;\n    }\n\n    var path = \"files/\".concat(name);\n    return _CoreManager.default.getRESTController().request('POST', path, data, options);\n  },\n  download: function (uri, options) {\n    if (XHR) {\n      return this.downloadAjax(uri, options);\n    }\n\n    return _promise.default.reject('Cannot make a request: No definition of XMLHttpRequest was found.');\n  },\n  downloadAjax: function (uri, options) {\n    return new _promise.default(function (resolve, reject) {\n      var xhr = new XHR();\n      xhr.open('GET', uri, true);\n      xhr.responseType = 'arraybuffer';\n\n      xhr.onerror = function (e) {\n        reject(e);\n      };\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState !== xhr.DONE) {\n          return;\n        }\n\n        if (!this.response) {\n          return resolve({});\n        }\n\n        var bytes = new Uint8Array(this.response);\n        resolve({\n          base64: (0, _ParseFileEncode.encodeBase64)(bytes),\n          contentType: xhr.getResponseHeader('content-type')\n        });\n      };\n\n      options.requestTask(xhr);\n      xhr.send();\n    });\n  },\n  deleteFile: function (name\n  /*: string*/\n  , options\n  /*:: ?: FullOptions*/\n  ) {\n    var headers = {\n      'X-Parse-Application-ID': _CoreManager.default.get('APPLICATION_ID')\n    };\n\n    if (options.useMasterKey) {\n      headers['X-Parse-Master-Key'] = _CoreManager.default.get('MASTER_KEY');\n    }\n\n    var url = _CoreManager.default.get('SERVER_URL');\n\n    if (url[url.length - 1] !== '/') {\n      url += '/';\n    }\n\n    url += \"files/\".concat(name);\n    return _CoreManager.default.getRESTController().ajax('DELETE', url, '', headers).catch(function (response) {\n      // TODO: return JSON object in server\n      if (!response || response === 'SyntaxError: Unexpected end of JSON input') {\n        return _promise.default.resolve();\n      }\n\n      return _CoreManager.default.getRESTController().handleError(response);\n    });\n  },\n  _setXHR: function (xhr\n  /*: any*/\n  ) {\n    XHR = xhr;\n  },\n  _getXHR: function () {\n    return XHR;\n  }\n};\nmodule.exports = DefaultController;","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/Twitter-Start/node_modules/moralis/lib/browser/ParseFileController.default.js"],"names":["_Object$keys","require","_Object$getOwnPropertySymbols","_filterInstanceProperty","_Object$getOwnPropertyDescriptor","_forEachInstanceProperty","_Object$getOwnPropertyDescriptors","_Object$defineProperties","_Object$defineProperty","_interopRequireDefault","_regenerator","_promise","_indexOf","_defineProperty2","_slicedToArray2","_asyncToGenerator2","_CoreManager","_ParseFileEncode","ownKeys","object","enumerableOnly","keys","symbols","call","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","_context2","_context3","source","Object","key","default","XHR","XMLHttpRequest","DefaultController","saveFile","_saveFile","mark","_callee","name","options","base64Data","_base64Data$split","_base64Data$split2","first","second","data","newSource","wrap","_context","prev","next","format","Error","res","rej","reader","FileReader","onload","result","onerror","error","readAsDataURL","file","sent","split","base64","type","saveBase64","abrupt","stop","fileData","ipfs","metadata","tags","_ContentType","path","concat","getRESTController","request","download","uri","downloadAjax","reject","resolve","xhr","open","responseType","e","onreadystatechange","readyState","DONE","response","bytes","Uint8Array","encodeBase64","contentType","getResponseHeader","requestTask","send","deleteFile","headers","get","useMasterKey","url","ajax","catch","handleError","_setXHR","_getXHR","module","exports"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _Object$keys = require(\"@babel/runtime-corejs3/core-js-stable/object/keys\");\n\nvar _Object$getOwnPropertySymbols = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\");\n\nvar _filterInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\");\n\nvar _Object$getOwnPropertyDescriptor = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\");\n\nvar _forEachInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\");\n\nvar _Object$getOwnPropertyDescriptors = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\");\n\nvar _Object$defineProperties = require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/slicedToArray\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\n\nvar _ParseFileEncode = require(\"./ParseFileEncode\");\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = _Object$keys(object);\n\n  if (_Object$getOwnPropertySymbols) {\n    var symbols = _Object$getOwnPropertySymbols(object);\n\n    enumerableOnly && (symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var _context2, _context3;\n\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? _forEachInstanceProperty(_context2 = ownKeys(Object(source), !0)).call(_context2, function (key) {\n      (0, _defineProperty2.default)(target, key, source[key]);\n    }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)) : _forEachInstanceProperty(_context3 = ownKeys(Object(source))).call(_context3, function (key) {\n      _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar XHR = null;\n\nif (typeof XMLHttpRequest !== 'undefined') {\n  XHR = XMLHttpRequest;\n}\n\nvar DefaultController = {\n  saveFile: function () {\n    var _saveFile = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(name\n    /*: string*/\n    , source\n    /*: FileSource*/\n    , options\n    /*:: ?: FullOptions*/\n    ) {\n      var base64Data, _base64Data$split, _base64Data$split2, first, second, data, newSource;\n\n      return _regenerator.default.wrap(function (_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(source.format !== 'file')) {\n                _context.next = 2;\n                break;\n              }\n\n              throw new Error('saveFile can only be used with File-type sources.');\n\n            case 2:\n              _context.next = 4;\n              return new _promise.default(function (res, rej) {\n                // eslint-disable-next-line no-undef\n                var reader = new FileReader();\n\n                reader.onload = function () {\n                  return res(reader.result);\n                };\n\n                reader.onerror = function (error) {\n                  return rej(error);\n                };\n\n                reader.readAsDataURL(source.file);\n              });\n\n            case 4:\n              base64Data = _context.sent; // we only want the data after the comma\n              // For example: \"data:application/pdf;base64,JVBERi0xLjQKJ...\" we would only want \"JVBERi0xLjQKJ...\"\n\n              _base64Data$split = base64Data.split(','), _base64Data$split2 = (0, _slicedToArray2.default)(_base64Data$split, 2), first = _base64Data$split2[0], second = _base64Data$split2[1]; // in the event there is no 'data:application/pdf;base64,' at the beginning of the base64 string\n              // use the entire string instead\n\n              data = second ? second : first;\n              newSource = {\n                format: 'base64',\n                base64: data,\n                type: source.type || (source.file ? source.file.type : null)\n              };\n              _context.next = 10;\n              return DefaultController.saveBase64(name, newSource, options);\n\n            case 10:\n              return _context.abrupt(\"return\", _context.sent);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function () {\n      return _saveFile.apply(this, arguments);\n    };\n  }(),\n  saveBase64: function (name\n  /*: string*/\n  , source\n  /*: FileSource*/\n  , options\n  /*:: ?: FullOptions*/\n  ) {\n    if (source.format !== 'base64') {\n      throw new Error('saveBase64 can only be used with Base64-type sources.');\n    }\n\n    var data\n    /*: { base64: any, _ContentType?: any, fileData: Object }*/\n    = {\n      base64: source.base64,\n      fileData: {\n        ipfs: options.ipfs,\n        metadata: _objectSpread({}, options.metadata),\n        tags: _objectSpread({}, options.tags)\n      }\n    };\n    delete options.metadata;\n    delete options.tags;\n\n    if (source.type) {\n      data._ContentType = source.type;\n    }\n\n    var path = \"files/\".concat(name);\n    return _CoreManager.default.getRESTController().request('POST', path, data, options);\n  },\n  download: function (uri, options) {\n    if (XHR) {\n      return this.downloadAjax(uri, options);\n    }\n\n    return _promise.default.reject('Cannot make a request: No definition of XMLHttpRequest was found.');\n  },\n  downloadAjax: function (uri, options) {\n    return new _promise.default(function (resolve, reject) {\n      var xhr = new XHR();\n      xhr.open('GET', uri, true);\n      xhr.responseType = 'arraybuffer';\n\n      xhr.onerror = function (e) {\n        reject(e);\n      };\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState !== xhr.DONE) {\n          return;\n        }\n\n        if (!this.response) {\n          return resolve({});\n        }\n\n        var bytes = new Uint8Array(this.response);\n        resolve({\n          base64: (0, _ParseFileEncode.encodeBase64)(bytes),\n          contentType: xhr.getResponseHeader('content-type')\n        });\n      };\n\n      options.requestTask(xhr);\n      xhr.send();\n    });\n  },\n  deleteFile: function (name\n  /*: string*/\n  , options\n  /*:: ?: FullOptions*/\n  ) {\n    var headers = {\n      'X-Parse-Application-ID': _CoreManager.default.get('APPLICATION_ID')\n    };\n\n    if (options.useMasterKey) {\n      headers['X-Parse-Master-Key'] = _CoreManager.default.get('MASTER_KEY');\n    }\n\n    var url = _CoreManager.default.get('SERVER_URL');\n\n    if (url[url.length - 1] !== '/') {\n      url += '/';\n    }\n\n    url += \"files/\".concat(name);\n    return _CoreManager.default.getRESTController().ajax('DELETE', url, '', headers).catch(function (response) {\n      // TODO: return JSON object in server\n      if (!response || response === 'SyntaxError: Unexpected end of JSON input') {\n        return _promise.default.resolve();\n      }\n\n      return _CoreManager.default.getRESTController().handleError(response);\n    });\n  },\n  _setXHR: function (xhr\n  /*: any*/\n  ) {\n    XHR = xhr;\n  },\n  _getXHR: function () {\n    return XHR;\n  }\n};\nmodule.exports = DefaultController;"]},"metadata":{},"sourceType":"script"}