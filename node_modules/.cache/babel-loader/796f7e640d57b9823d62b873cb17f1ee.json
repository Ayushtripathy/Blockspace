{"ast":null,"code":"\"use strict\";\n\nvar _Reflect$construct = require(\"@babel/runtime-corejs3/core-js-stable/reflect/construct\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/getPrototypeOf\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _ethers = require(\"ethers\");\n\nvar _AbstractWeb3Connector = _interopRequireDefault(require(\"./AbstractWeb3Connector\"));\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function () {\n    var Super = (0, _getPrototypeOf2.default)(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2.default)(this).constructor;\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2.default)(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(_Reflect$construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar MagicWeb3Connector = /*#__PURE__*/function (_AbstractWeb3Connecto) {\n  (0, _inherits2.default)(MagicWeb3Connector, _AbstractWeb3Connecto);\n\n  var _super = _createSuper(MagicWeb3Connector);\n\n  function MagicWeb3Connector() {\n    var _context;\n\n    var _this;\n\n    (0, _classCallCheck2.default)(this, MagicWeb3Connector);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, (0, _concat.default)(_context = [this]).call(_context, args));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"type\", 'MagicLink');\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"deactivate\", /*#__PURE__*/(0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n      return _regenerator.default.wrap(function (_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _this.unsubscribeToEvents(_this.provider);\n\n              if (!_this.magicUser) {\n                _context2.next = 4;\n                break;\n              }\n\n              _context2.next = 4;\n              return _this.magicUser.user.logout();\n\n            case 4:\n              _this.account = null;\n              _this.chainId = null;\n              _this.provider = null;\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee);\n    })));\n    return _this;\n  }\n\n  (0, _createClass2.default)(MagicWeb3Connector, [{\n    key: \"activate\",\n    value: function () {\n      var _activate = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n        var _ref2,\n            email,\n            apiKey,\n            network,\n            newSession,\n            magic,\n            ether,\n            Magic,\n            _require,\n            _window,\n            _magic,\n            _magic2,\n            _magic2$user,\n            loggedIn,\n            signer,\n            _yield$ether$getNetwo,\n            chainId,\n            address,\n            _args2 = arguments;\n\n        return _regenerator.default.wrap(function (_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _ref2 = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : {}, email = _ref2.email, apiKey = _ref2.apiKey, network = _ref2.network, newSession = _ref2.newSession;\n                magic = null;\n                ether = null;\n\n                if (email) {\n                  _context3.next = 5;\n                  break;\n                }\n\n                throw new Error('\"email\" not provided, please provide Email');\n\n              case 5:\n                if (apiKey) {\n                  _context3.next = 7;\n                  break;\n                }\n\n                throw new Error('\"apiKey\" not provided, please provide Api Key');\n\n              case 7:\n                if (network) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                throw new Error('\"network\" not provided, please provide network');\n\n              case 9:\n                try {\n                  Magic = (_require = require('magic-sdk')) === null || _require === void 0 ? void 0 : _require.Magic;\n                } catch (error) {// Do nothing. User might not need walletconnect\n                }\n\n                if (!Magic) {\n                  Magic = (_window = window) === null || _window === void 0 ? void 0 : _window.Magic;\n                }\n\n                if (Magic) {\n                  _context3.next = 13;\n                  break;\n                }\n\n                throw new Error('Cannot enable via MagicLink: dependency \"magic-sdk\" is missing');\n\n              case 13:\n                _context3.prev = 13;\n                magic = new Magic(apiKey, {\n                  network: network\n                });\n\n                if (!newSession) {\n                  _context3.next = 24;\n                  break;\n                }\n\n                if (!((_magic = magic) !== null && _magic !== void 0 && _magic.user)) {\n                  _context3.next = 24;\n                  break;\n                }\n\n                _context3.prev = 17;\n                _context3.next = 20;\n                return (_magic2 = magic) === null || _magic2 === void 0 ? void 0 : (_magic2$user = _magic2.user) === null || _magic2$user === void 0 ? void 0 : _magic2$user.logout();\n\n              case 20:\n                _context3.next = 24;\n                break;\n\n              case 22:\n                _context3.prev = 22;\n                _context3.t0 = _context3[\"catch\"](17);\n\n              case 24:\n                ether = new _ethers.ethers.providers.Web3Provider(magic.rpcProvider);\n                _context3.next = 27;\n                return magic.auth.loginWithMagicLink({\n                  email: email\n                });\n\n              case 27:\n                _context3.next = 32;\n                break;\n\n              case 29:\n                _context3.prev = 29;\n                _context3.t1 = _context3[\"catch\"](13);\n                throw new Error('Error during enable via MagicLink, please double check network and apikey');\n\n              case 32:\n                _context3.next = 34;\n                return magic.user.isLoggedIn();\n\n              case 34:\n                loggedIn = _context3.sent;\n\n                if (!loggedIn) {\n                  _context3.next = 50;\n                  break;\n                }\n\n                signer = ether.getSigner();\n                _context3.next = 39;\n                return ether.getNetwork();\n\n              case 39:\n                _yield$ether$getNetwo = _context3.sent;\n                chainId = _yield$ether$getNetwo.chainId;\n                _context3.next = 43;\n                return signer.getAddress();\n\n              case 43:\n                address = _context3.sent.toLowerCase(); // Assign Constants\n\n                this.account = address;\n                this.provider = ether.provider;\n                this.chainId = \"0x\".concat(chainId.toString(16)); // Assign magic user for deactivation\n\n                this.magicUser = magic;\n                this.subscribeToEvents(this.provider);\n                return _context3.abrupt(\"return\", {\n                  provider: this.provider,\n                  account: this.account,\n                  chainId: this.chainId\n                });\n\n              case 50:\n                throw new Error('Error during enable via MagicLink, login to magic failed');\n\n              case 51:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee2, this, [[13, 29], [17, 22]]);\n      }));\n\n      return function () {\n        return _activate.apply(this, arguments);\n      };\n    }()\n  }]);\n  return MagicWeb3Connector;\n}(_AbstractWeb3Connector.default);\n\nexports.default = MagicWeb3Connector;","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/Twitter-Start/node_modules/moralis/lib/browser/Web3Connector/MagicWeb3Connector.js"],"names":["_Reflect$construct","require","_Object$defineProperty","_interopRequireDefault","exports","value","default","_regenerator","_concat","_asyncToGenerator2","_classCallCheck2","_createClass2","_assertThisInitialized2","_inherits2","_possibleConstructorReturn2","_getPrototypeOf2","_defineProperty2","_ethers","_AbstractWeb3Connector","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","Super","result","NewTarget","constructor","arguments","apply","Reflect","sham","Proxy","Boolean","prototype","valueOf","call","e","MagicWeb3Connector","_AbstractWeb3Connecto","_super","_context","_this","_len","length","args","Array","_key","mark","_callee","wrap","_context2","prev","next","unsubscribeToEvents","provider","magicUser","user","logout","account","chainId","stop","key","_activate","_callee2","_ref2","email","apiKey","network","newSession","magic","ether","Magic","_require","_window","_magic","_magic2","_magic2$user","loggedIn","signer","_yield$ether$getNetwo","address","_args2","_context3","undefined","Error","error","window","t0","ethers","providers","Web3Provider","rpcProvider","auth","loginWithMagicLink","t1","isLoggedIn","sent","getSigner","getNetwork","getAddress","toLowerCase","concat","toString","subscribeToEvents","abrupt"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _Reflect$construct = require(\"@babel/runtime-corejs3/core-js-stable/reflect/construct\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/getPrototypeOf\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _ethers = require(\"ethers\");\n\nvar _AbstractWeb3Connector = _interopRequireDefault(require(\"./AbstractWeb3Connector\"));\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function () {\n    var Super = (0, _getPrototypeOf2.default)(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2.default)(this).constructor;\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2.default)(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(_Reflect$construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar MagicWeb3Connector = /*#__PURE__*/function (_AbstractWeb3Connecto) {\n  (0, _inherits2.default)(MagicWeb3Connector, _AbstractWeb3Connecto);\n\n  var _super = _createSuper(MagicWeb3Connector);\n\n  function MagicWeb3Connector() {\n    var _context;\n\n    var _this;\n\n    (0, _classCallCheck2.default)(this, MagicWeb3Connector);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, (0, _concat.default)(_context = [this]).call(_context, args));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"type\", 'MagicLink');\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"deactivate\", /*#__PURE__*/(0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n      return _regenerator.default.wrap(function (_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _this.unsubscribeToEvents(_this.provider);\n\n              if (!_this.magicUser) {\n                _context2.next = 4;\n                break;\n              }\n\n              _context2.next = 4;\n              return _this.magicUser.user.logout();\n\n            case 4:\n              _this.account = null;\n              _this.chainId = null;\n              _this.provider = null;\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee);\n    })));\n    return _this;\n  }\n\n  (0, _createClass2.default)(MagicWeb3Connector, [{\n    key: \"activate\",\n    value: function () {\n      var _activate = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n        var _ref2,\n            email,\n            apiKey,\n            network,\n            newSession,\n            magic,\n            ether,\n            Magic,\n            _require,\n            _window,\n            _magic,\n            _magic2,\n            _magic2$user,\n            loggedIn,\n            signer,\n            _yield$ether$getNetwo,\n            chainId,\n            address,\n            _args2 = arguments;\n\n        return _regenerator.default.wrap(function (_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _ref2 = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : {}, email = _ref2.email, apiKey = _ref2.apiKey, network = _ref2.network, newSession = _ref2.newSession;\n                magic = null;\n                ether = null;\n\n                if (email) {\n                  _context3.next = 5;\n                  break;\n                }\n\n                throw new Error('\"email\" not provided, please provide Email');\n\n              case 5:\n                if (apiKey) {\n                  _context3.next = 7;\n                  break;\n                }\n\n                throw new Error('\"apiKey\" not provided, please provide Api Key');\n\n              case 7:\n                if (network) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                throw new Error('\"network\" not provided, please provide network');\n\n              case 9:\n                try {\n                  Magic = (_require = require('magic-sdk')) === null || _require === void 0 ? void 0 : _require.Magic;\n                } catch (error) {// Do nothing. User might not need walletconnect\n                }\n\n                if (!Magic) {\n                  Magic = (_window = window) === null || _window === void 0 ? void 0 : _window.Magic;\n                }\n\n                if (Magic) {\n                  _context3.next = 13;\n                  break;\n                }\n\n                throw new Error('Cannot enable via MagicLink: dependency \"magic-sdk\" is missing');\n\n              case 13:\n                _context3.prev = 13;\n                magic = new Magic(apiKey, {\n                  network: network\n                });\n\n                if (!newSession) {\n                  _context3.next = 24;\n                  break;\n                }\n\n                if (!((_magic = magic) !== null && _magic !== void 0 && _magic.user)) {\n                  _context3.next = 24;\n                  break;\n                }\n\n                _context3.prev = 17;\n                _context3.next = 20;\n                return (_magic2 = magic) === null || _magic2 === void 0 ? void 0 : (_magic2$user = _magic2.user) === null || _magic2$user === void 0 ? void 0 : _magic2$user.logout();\n\n              case 20:\n                _context3.next = 24;\n                break;\n\n              case 22:\n                _context3.prev = 22;\n                _context3.t0 = _context3[\"catch\"](17);\n\n              case 24:\n                ether = new _ethers.ethers.providers.Web3Provider(magic.rpcProvider);\n                _context3.next = 27;\n                return magic.auth.loginWithMagicLink({\n                  email: email\n                });\n\n              case 27:\n                _context3.next = 32;\n                break;\n\n              case 29:\n                _context3.prev = 29;\n                _context3.t1 = _context3[\"catch\"](13);\n                throw new Error('Error during enable via MagicLink, please double check network and apikey');\n\n              case 32:\n                _context3.next = 34;\n                return magic.user.isLoggedIn();\n\n              case 34:\n                loggedIn = _context3.sent;\n\n                if (!loggedIn) {\n                  _context3.next = 50;\n                  break;\n                }\n\n                signer = ether.getSigner();\n                _context3.next = 39;\n                return ether.getNetwork();\n\n              case 39:\n                _yield$ether$getNetwo = _context3.sent;\n                chainId = _yield$ether$getNetwo.chainId;\n                _context3.next = 43;\n                return signer.getAddress();\n\n              case 43:\n                address = _context3.sent.toLowerCase(); // Assign Constants\n\n                this.account = address;\n                this.provider = ether.provider;\n                this.chainId = \"0x\".concat(chainId.toString(16)); // Assign magic user for deactivation\n\n                this.magicUser = magic;\n                this.subscribeToEvents(this.provider);\n                return _context3.abrupt(\"return\", {\n                  provider: this.provider,\n                  account: this.account,\n                  chainId: this.chainId\n                });\n\n              case 50:\n                throw new Error('Error during enable via MagicLink, login to magic failed');\n\n              case 51:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee2, this, [[13, 29], [17, 22]]);\n      }));\n\n      return function () {\n        return _activate.apply(this, arguments);\n      };\n    }()\n  }]);\n  return MagicWeb3Connector;\n}(_AbstractWeb3Connector.default);\n\nexports.default = MagicWeb3Connector;"]},"metadata":{},"sourceType":"script"}